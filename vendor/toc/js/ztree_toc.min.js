!function($){function _encode_id_with_array(e,t){for(var n=0,r=0;r<t.length;r++)n+=_factor(e,t.length-r,t[r]);return n}function _get_parent_id_with_array(e,t){for(var n=[],r=0;r<t.length;r++)n.push(t[r]);n.pop();for(var o=0,r=0;r<n.length;r++)o+=_factor(e,n.length-r,n[r]);return o}function _factor(opts,count,current){if(1==count)return current;for(var str="",i=count-1;0<i;i--)str+=current*opts.step+"*",current=1;return eval(str+"1")}function _create_toc(t){t.t={},t.o=null,$(t.documment_selector).find(":header").each(function(){var e=parseInt(this.nodeName.substring(1),10);t.o=$(this).text(),_rename_header_content(t,this,e),_add_header_node(t,$(this))}),t.i=null,t.t=null,t.o=null}function _render_with_ztree(e){var t=$(e._);$.fn.zTree.init(t,e.ztreeSetting,e.l).expandAll(e.is_expand_all);$(e._).css(e.ztreeStyle)}function _rename_header_content(e,t,n){if(e.i.length==n)e.i[n-1]++;else if(e.i.length>n)e.i=e.i.slice(0,n),e.i[n-1]++;else for(;e.i.length<n;)e.i.push(1);1==e.is_auto_number&&-1==$(t).text().indexOf(e.i.join("."))&&$(t).text(e.i.join(".")+". "+$(t).text())}function _add_header_node(e,t){var n=_encode_id_with_array(e,e.i);e.t[n]=e.o;var n=e.o,r=_get_parent_id_with_array(e,e.i),r=e.t[r];$(t).attr("id",n),$(t).text(),e.u.push($(t).offset().top-e.highlight_offset),$(t).offset().top,e.highlight_offset,e.l.push({id:n,pId:r,name:$(t).text()||"null",open:!0,url:"#"+n,target:"_self"})}function _bind_scroll_event_and_update_postion(r){function e(e){t&&clearTimeout(t),t=setTimeout(function(){var e=$(window).scrollTop();r.debug;for(var t=0,n=r.u.length;t<n;t++)if(r.u[t]>=e+5){$("a").removeClass("curSelectedNode");$("#tree_"+(t+1)+"_a").addClass("curSelectedNode");break}},r.refresh_scroll_time)}var t;r.highlight_on_scroll&&($(window).bind("scroll",e),e())}function _init_with_config(e){e.highlight_offset=$(e.documment_selector).offset().top}function _log(e){}$.fn.ztree_toc=function(e){var t=$.extend({},$.fn.ztree_toc.defaults,e);return this.each(function(){t._=$(this),_init_with_config(t),_create_toc(t),_render_with_ztree(t),_bind_scroll_event_and_update_postion(t)})},$.fn.ztree_toc.defaults={_:null,i:[],u:[],l:[{id:1,pId:0,name:"目录",open:!0}],debug:!0,highlight_offset:0,highlight_on_scroll:!0,refresh_scroll_time:50,documment_selector:"body",is_posion_top:!1,is_auto_number:!1,is_expand_all:!0,is_highlight_selected_line:!0,step:100,ztreeStyle:{width:"260px",overflow:"auto",position:"fixed","z-index":2147483647,border:"0px none",left:"0px",bottom:"0px"},ztreeSetting:{view:{dblClickExpand:!1,showLine:!0,showIcon:!1,selectedMulti:!1},data:{simpleData:{enable:!0,idKey:"id",pIdKey:"pId"}},callback:{beforeClick:function(e,t){$("a").removeClass("curSelectedNode"),t.id,1==$.fn.ztree_toc.defaults.is_highlight_selected_line&&$("#"+t.id).css("color","red").fadeOut("slow",function(){$(this).show().css("color","black")})},onRightClick:function(e,t,n){n.id}}}}}(jQuery);